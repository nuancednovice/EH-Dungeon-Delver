function e(e,t,a,o){Object.defineProperty(e,t,{get:a,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},n={},r=a.parcelRequireb3d8;null==r&&((r=function(e){if(e in o)return o[e].exports;if(e in n){var t=n[e];delete n[e];var a={id:e,exports:{}};return o[e]=a,t.call(a.exports,a,a.exports),a.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){n[e]=t},a.parcelRequireb3d8=r),r.register("hqokU",(function(t,a){var o,n;e(t.exports,"register",(function(){return o}),(function(e){return o=e})),e(t.exports,"resolve",(function(){return n}),(function(e){return n=e}));var r={};o=function(e){for(var t=Object.keys(e),a=0;a<t.length;a++)r[t[a]]=e[t[a]]},n=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r("hqokU").register(JSON.parse('{"bmkhr":"index.c1c61e67.js","8nKLE":"axe.eec4e090.png","a2NfX":"bow.944717d8.png","g2a99":"breastplate.029e9e8c.png","97Utg":"card-back.e504cf08.png","d0UnH":"crowned-skull.8579f3e0.png","cfqH7":"crystal.03273f4c.png","3Ah6t":"dagger.04f605cd.png","b2azx":"discard.2d3416af.png","3E24j":"divine.415fcccc.png","hGtPC":"dungeon-gate.13687493.png","4DXi9":"dungeon-tunnel.0974e5f4.png","gpfow":"electric.52cadc0f.png","A9VMe":"fire.eba5fb17.png","314xT":"gloves.1dde3f25.png","a7Hwd":"hammer.8cb3b127.png","5D9zZ":"helm.21ace6a5.png","2xWOI":"ice.c45746d1.png","aq6EG":"magic.585e066e.png","H4ZjI":"nature.67fb99cd.png","4KYqY":"poison.a7ca0b93.png","d7wK7":"potion.61e1733d.png","hefqU":"shuffle.b8ac0c89.png","dxuDv":"sword.9c07cdd5.png","eFQPd":"water.3aae5af5.png","fx1J3":"service-worker.js"}'));class s{__commitStateChange(e){this.__state=e}setState(e){const t=Object.assign(this.__state,e);return{commit:()=>this.__commitStateChange(t),value:t}}constructor(e){return this.__state=e,new Proxy(this,{get(e,t){var a,o;return null!==(o=null!==(a=e[t])&&void 0!==a?a:e.__state[t])&&void 0!==o?o:void 0}})}}function c(e){return e.split(" ").map((e=>2===e.length?e:e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}class i extends s{constructor(e){var t,a;super({actionTaken:!1,ad:e.armor,armor:e.armor,hp:e.health,isBoss:null!==(t=e.isBoss)&&void 0!==t&&t,maxAd:e.armor,maxHp:e.health,maxMp:e.mana,mp:e.mana,name:c(e.name),raw:e,statModifier:null!==(a=e.modifier)&&void 0!==a?a:1,status:"normal",statusDuration:0})}}var m=[{armor:1,attack:1,gold:2,health:3,mana:0,name:"dragon"}];function d(e){return Math.round(1e5*Math.random())/1e5<e}var l=[{armor:1,attack:1,gold:2,health:1,level:1,mana:0,name:"swarm of rats",specials:[{chance:.45,cost:1,damage:2,effect:"damage",message:{copy:"Enemy %1 engulfs your body dealing %2 damage",direction:"outbound"}}],weakness:"fire"},{armor:0,attack:1,gold:3,health:1,level:1,mana:0,name:"kobold"},{armor:0,attack:2,gold:3,health:2,level:1,mana:0,name:"goblin",weakness:"fire"},{armor:2,attack:2,gold:3,health:2,level:1,mana:4,name:"skeleton",resistance:"poison",specials:[{chance:.4,damage:2,effect:"damage",message:{copy:"Enemy %1 flings a bone at you dealing %2 damage",direction:"outbound"}},{chance:.2,cost:1,duration:2,effect:"poison",message:{copy:"Enemy %1 releases a scent of death giving you poison",direction:"outbound"}}]},{armor:0,attack:2,gold:4,health:3,level:2,mana:0,name:"gnoll",resistance:"nature",weakness:"fire"},{armor:0,attack:2,gold:5,health:3,level:2,mana:6,name:"grey ooze",resistance:"water",specials:[{chance:.45,cost:2,damage:3,effect:"damage",message:{copy:"Enemy %1 douses you sticky liquid dealing %2 damage",direction:"outbound"}}],weakness:"electric"},{armor:2,attack:3,gold:5,health:3,level:2,mana:0,name:"orc warrior",specials:[{chance:.4,damage:3,effect:"damage",message:{copy:"Enemy %1 charges at you dealing %2 damage",direction:"outbound"}},{chance:.15,damage:4,effect:"damage",message:{copy:"Enemy %1 goes beserk hitting you for %2 damage",direction:"outbound"}}]},{armor:1,attack:3,gold:5,health:4,level:2,mana:0,name:"worg",specials:[{chance:.2,damage:4,effect:"damage",message:{copy:"Enemy %1 bites you dealing %2 damage",direction:"outbound"}},{chance:.2,damage:4,effect:"damage",message:{copy:"Enemy %1 claws you dealing %2 damage",direction:"outbound"}}]},{armor:2,attack:4,gold:5,health:4,level:2,mana:0,name:"bugbear",specials:[{chance:.45,damage:5,effect:"damage",message:{copy:"Enemy %1 launches a surprise attack dealing %2 damage",direction:"outbound"}}]},{armor:0,attack:3,gold:5,health:4,level:2,mana:5,name:"nilbog",specials:[{chance:.3,cost:2,damage:4,effect:"damage",element:"fire",message:{copy:"Enemy %1 projects a fireball dealing %2 damage",direction:"outbound"}},{chance:.3,damage:4,effect:"damage",element:"electric",message:{copy:"Enemy %1 shocks you for %2 damage",direction:"outbound"}},{chance:.3,cost:1,duration:2,effect:"poison",message:{copy:"Enemy %1 releases a sickening poison",direction:"outbound"}}],weakness:"fire"},{armor:0,attack:4,gold:5,health:6,level:3,mana:0,name:"giant spider",resistance:"poison",specials:[{chance:.4,duration:3,effect:"poison",message:{copy:"Enemy %1 shoots a poison web at you",direction:"outbound"}},{chance:.2,damage:5,effect:"damage",message:{copy:"Enemy %1 bites you dealing %2 damage",direction:"outbound"}}],weakness:"fire"},{armor:0,attack:5,gold:5,health:6,level:3,mana:5,name:"harpy",resistance:"poison",weakness:"fire"},{armor:2,attack:4,gold:4,health:4,level:3,mana:6,name:"gargoyle",resistance:"poison",specials:[{chance:.3,cost:2,damage:5,effect:"damage",element:"nature",message:{copy:"Enemy %1 throws stone at you for %2 damage",direction:"outbound"}},{chance:.4,cost:3,duration:3,effect:"ice",message:{copy:"Enemy %1 freezes you motionless",direction:"outbound"}},{armor:2,chance:.45,cost:2,effect:"protect",message:{copy:"Enemy %1 protects itself",direction:"outbound"}}]},{armor:0,attack:1,gold:7,health:6,level:3,mana:6,name:"mimic",specials:[{chance:.45,damage:2,effect:"damage",message:{copy:"Enemy %1 bites you for %2 damage",direction:"outbound"}},{chance:.3,cost:2,damage:2,effect:"damage",message:{copy:"Enemy %1 transforms and hits you for %2 damage",direction:"outbound"}},{armor:4,chance:.15,effect:"protect",message:{copy:"Enemy %1 protects itself",direction:"outbound"}}]},{armor:4,attack:6,gold:10,health:7,level:4,mana:0,name:"quaggoth"},{armor:5,attack:6,gold:10,health:7,level:4,mana:6,name:"basalisk",resistance:"ice",specials:[{armor:4,chance:.35,cost:2,effect:"protect",message:{copy:"Enemy %1 protects itself",direction:"outbound"}},{chance:.3,duration:4,effect:"ice",message:{copy:"Enemy %1 freezes you motionless",direction:"outbound"}}]},{armor:0,attack:6,gold:12,health:7,level:4,mana:0,name:"doppelganger",weakness:"water"},{armor:0,attack:6,gold:11,health:7,level:4,mana:0,name:"minotaur"},{armor:0,attack:7,gold:9,health:7,level:5,mana:0,name:"banshee"},{armor:0,attack:7,gold:10,health:8,level:5,mana:0,name:"demogorgon",resistance:"poison"},{armor:0,attack:8,gold:11,health:10,level:5,mana:0,name:"troll",resistance:"nature"},{armor:0,attack:10,gold:11,health:11,level:5,mana:0,name:"wyvern",resistance:"fire",specials:[{chance:.2,damage:10,effect:"damage",element:"fire",message:{copy:"Enemy %1 breathes fire scorching you for %2 damage",direction:"outbound"}}]}];function u(e,t={}){const a=new CustomEvent(e,{detail:t});window.dispatchEvent(a)}function h(e){let t,a,o=e.length;for(e=e.slice(0);0!==o;)a=Math.floor(Math.random()*o),o-=1,t=e[o],e[o]=e[a],e[a]=t;return e}function f(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}const _={creatures:[],level:1};var p=new class extends s{advance(){const e=[...this.creatures];e.splice(0,1),0===e.length&&(u("PLAYER_UPDATE_STATS"),u("ENTER_SHOP")),this.setState({creatures:e}).commit()}generateDungeonBoss(){const e=h(m)[0],t=1.5*this.level;return Array.from(Array(1).keys()).map((()=>new i(Object.assign({id:f(),isBoss:!0},e,{armor:e.armor*t,attack:e.attack*t,gold:e.gold*t,health:e.health*t,mana:e.mana*t,modifier:t}))))}generateDungeonCreatures(){if(this.level%2==0&&d(.4))return this.generateDungeonBoss();const e=l.reduce(((e,t)=>Math.max(e,t.level)),0),t=this.level<e?this.level:e,a=[t-1,t],o=l.filter((e=>a.includes(e.level))),n=t+2;return Array.from(Array(n).keys()).map((()=>new i(Object.assign({id:f()},h(o)[0]))))}constructor(e){super(e),this.setState({creatures:this.generateDungeonCreatures()}).commit()}}({..._}),g={};e(g,"Axe",(function(){return t(v)})),e(g,"Bow",(function(){return t(T)})),e(g,"Breastplate",(function(){return t(E)})),e(g,"CardBack",(function(){return t(A)})),e(g,"CrownedSkull",(function(){return t(y)})),e(g,"Crystal",(function(){return t(S)})),e(g,"Dagger",(function(){return t(b)})),e(g,"Discard",(function(){return t(R)})),e(g,"Divine",(function(){return t(C)})),e(g,"DungeonGate",(function(){return t(D)})),e(g,"DungeonTunnel",(function(){return t(k)})),e(g,"Electric",(function(){return t(L)})),e(g,"Fire",(function(){return t(P)})),e(g,"Gloves",(function(){return t(w)})),e(g,"Hammer",(function(){return t(U)})),e(g,"Helm",(function(){return t(F)})),e(g,"Ice",(function(){return t(H)})),e(g,"Magic",(function(){return t(M)})),e(g,"Nature",(function(){return t(x)})),e(g,"Poison",(function(){return t(Y)})),e(g,"Potion",(function(){return t($)})),e(g,"Shuffle",(function(){return t(N)})),e(g,"Sword",(function(){return t(B)})),e(g,"Water",(function(){return t(q)}));var v={};v=new URL(r("hqokU").resolve("8nKLE"),import.meta.url).toString();var T={};T=new URL(r("hqokU").resolve("a2NfX"),import.meta.url).toString();var E={};E=new URL(r("hqokU").resolve("g2a99"),import.meta.url).toString();var A={};A=new URL(r("hqokU").resolve("97Utg"),import.meta.url).toString();var y={};y=new URL(r("hqokU").resolve("d0UnH"),import.meta.url).toString();var S={};S=new URL(r("hqokU").resolve("cfqH7"),import.meta.url).toString();var b={};b=new URL(r("hqokU").resolve("3Ah6t"),import.meta.url).toString();var R={};R=new URL(r("hqokU").resolve("b2azx"),import.meta.url).toString();var C={};C=new URL(r("hqokU").resolve("3E24j"),import.meta.url).toString();var D={};D=new URL(r("hqokU").resolve("hGtPC"),import.meta.url).toString();var k={};k=new URL(r("hqokU").resolve("4DXi9"),import.meta.url).toString();var L={};L=new URL(r("hqokU").resolve("gpfow"),import.meta.url).toString();var P={};P=new URL(r("hqokU").resolve("A9VMe"),import.meta.url).toString();var w={};w=new URL(r("hqokU").resolve("314xT"),import.meta.url).toString();var U={};U=new URL(r("hqokU").resolve("a7Hwd"),import.meta.url).toString();var F={};F=new URL(r("hqokU").resolve("5D9zZ"),import.meta.url).toString();var H={};H=new URL(r("hqokU").resolve("2xWOI"),import.meta.url).toString();var M={};M=new URL(r("hqokU").resolve("aq6EG"),import.meta.url).toString();var x={};x=new URL(r("hqokU").resolve("H4ZjI"),import.meta.url).toString();var Y={};Y=new URL(r("hqokU").resolve("4KYqY"),import.meta.url).toString();var $={};$=new URL(r("hqokU").resolve("d7wK7"),import.meta.url).toString();var N={};N=new URL(r("hqokU").resolve("hefqU"),import.meta.url).toString();var B={};B=new URL(r("hqokU").resolve("dxuDv"),import.meta.url).toString();var q={};function G(e=""){return c(e.split("-").join(" ")).split(" ").join("")}function I(e){var t;return null!==(t=g[G(e)])&&void 0!==t?t:void 0}function z(){const e=p.level,t=p.creatures[0],a="normal"!==t.status&&0!==t.statusDuration,o=t.hp/t.maxHp*100,n=t.mp/t.maxMp*100,r=t.ad/t.maxAd*100;return`\n    <div class="tm-c-creature">\n      <div class="tm-c-creature__tunnel">\n        <div class="tm-c-creature__name">\n          ${t.isBoss?'<div class="tm-c-creature__name-icon"></div>':""}\n          ${t.isBoss?"BOSS: ":""}${t.name}\n        </div>\n        <div class="tm-c-creature__level">\n          ${t.isBoss?`Lv. ${new Array(e.toString().length+1).join("X")}`:""}\n          ${t.isBoss?"":`Lv. ${t.raw.level}`}\n        </div>\n        <div class="tm-c-creature__attribute">\n          <div class="tm-c-creature__attribute-label">Weakness</div>\n          <div class="tm-c-creature__attribute-icon">\n            ${t.raw.weakness?`<img src="${I(t.raw.weakness)}" />`:""}\n          </div>\n        </div>\n        <div class="tm-c-creature__attribute">\n          <div class="tm-c-creature__attribute-label">Resistance</div>\n          <div class="tm-c-creature__attribute-icon">\n            ${t.raw.resistance?`<img src="${I(t.raw.resistance)}" />`:""}\n          </div>\n        </div>\n      </div>\n      <div class="tm-c-creature__stats">\n        <div class="tm-c-creature__stat" data-stat="health">\n          <div class="tm-c-creature__label">HP</div>\n          <div class="tm-c-creature__bar" style="width: ${o}%"></div>\n        </div>\n        <div class="tm-c-creature__stat" data-stat="mana">\n          <div class="tm-c-creature__label">MP</div>\n          <div class="tm-c-creature__bar" style="width: ${n}%"></div>\n        </div>\n        <div class="tm-c-creature__stat" data-stat="armor">\n          <div class="tm-c-creature__label">AR</div>\n          <div class="tm-c-creature__bar" style="width: ${r}%"></div>\n        </div>\n        <div class="tm-c-creature__stat">\n          <div class="tm-c-creature__status-label">Status Effect</div>\n          <div class="tm-c-creature__status-effect">\n            <div class="tm-c-creature__status-icon">\n              ${a?`<img src="${I(t.status)}" />`:""}\n            </div>\n            <div class="tm-c-creature__status-duration">\n              ${a?`x ${t.statusDuration} turns`:""}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `}q=new URL(r("hqokU").resolve("eFQPd"),import.meta.url).toString();var O=[{damage:1,effect:"damage",icon:"dagger",name:"dagger",set:"base"},{damage:2,effect:"damage",icon:"sword",name:"sword",set:"base"},{damage:3,effect:"damage",icon:"bow",name:"short bow",set:"base"},{cost:2,damage:1,effect:"damage",element:"fire",icon:"magic",name:"fireball",set:"base"},{cost:3,damage:2,effect:"damage",element:"water",icon:"magic",name:"drown",set:"base"},{cost:3,damage:2,effect:"damage",element:"nature",icon:"magic",name:"tangle",set:"base"},{armor:1,effect:"armor",icon:"gloves",name:"gloves",set:"base"},{armor:2,effect:"armor",icon:"helm",name:"helm",set:"base"},{armor:3,effect:"armor",icon:"breastplate",name:"chest",set:"base"},{effect:"heal",health:3,icon:"potion",name:"hp potion",set:"base"},{effect:"mana",icon:"potion",mana:3,name:"mp potion",set:"base"},{effect:"re-draw",icon:"shuffle",keyword:"re-draw",name:"whirlwind",set:"base"},{damage:3,effect:"damage",icon:"axe",name:"axe",price:3,set:1},{damage:4,effect:"damage",icon:"hammer",name:"hammer",price:4,set:1},{damage:5,effect:"damage",icon:"bow",name:"long bow",price:5,set:1},{cost:4,duration:2,effect:"freeze",element:"ice",icon:"magic",keyword:"freeze",name:"cold snap",price:4,set:1},{cost:4,duration:2,effect:"poison",element:"poison",icon:"magic",keyword:"poison",name:"smog",price:4,set:1},{cost:4,damage:5,effect:"damage",element:"electric",icon:"magic",name:"lightning bolt",price:4,set:1,size:"12px"},{armor:4,effect:"armor",icon:"gloves",name:"brass gloves",price:4,set:1,size:"14px"},{armor:5,effect:"armor",icon:"helm",name:"brass helm",price:5,set:1},{armor:6,effect:"armor",icon:"breastplate",name:"brass chest",price:6,set:1},{effect:"heal",health:5,icon:"potion",name:"hp potion ii",price:3,set:1,size:"14px"},{effect:"mana",icon:"potion",mana:5,name:"mp potion ii",price:4,set:1,size:"14px"},{effect:"cure",icon:"crystal",keyword:"cure",name:"cure stone",price:5,set:1},{damage:5,effect:"damage",element:"water",icon:"dagger",name:"ocean dagger",price:6,set:2,size:"14px"},{damage:6,effect:"damage",element:"fire",icon:"sword",name:"flaming sword",price:7,set:2,size:"13px"},{damage:7,effect:"damage",element:"poison",icon:"bow",name:"dread bow",price:8,set:2},{cost:6,damage:7,effect:"damage",element:"fire",icon:"magic",name:"explosion",price:7,set:2},{cost:6,damage:7,effect:"damage",element:"electric",icon:"magic",name:"shock sphere",price:7,set:2,size:"14px"},{cost:7,damage:8,effect:"damage",element:"nature",icon:"magic",name:"stone wall",price:8,set:2},{armor:7,effect:"armor",icon:"gloves",name:"silver gloves",price:6,set:2,size:"13px"},{armor:8,effect:"armor",icon:"helm",name:"silver helm",price:7,set:2},{armor:9,effect:"armor",icon:"breastplate",name:"silver chest",price:8,set:2,size:"15px"},{effect:"heal",health:7,icon:"potion",name:"hp potion iii",price:7,set:2,size:"13px"},{effect:"mana",icon:"potion",mana:7,name:"mp potion iii",price:7,set:2,size:"13px"},{damage:7,effect:"damage",icon:"axe",name:"hunting axe",price:9,set:3,size:"15px"},{damage:8,effect:"damage",element:"ice",icon:"hammer",name:"icy blow",price:10,set:3},{damage:10,effect:"damage",element:"electric",icon:"bow",name:"storm bringer",price:11,set:3,size:"13px"},{cost:7,damage:9,effect:"damage",element:"ice",icon:"magic",name:"frost ray",price:8,set:3},{cost:7,damage:9,effect:"damage",element:"poison",icon:"magic",name:"venom",price:8,set:3},{cost:8,damage:10,effect:"damage",element:"water",icon:"magic",name:"tsunami",price:9,set:3},{armor:8,effect:"armor",icon:"gloves",name:"iron gloves",price:8,set:3},{armor:9,effect:"armor",icon:"helm",name:"iron helm",price:9,set:3},{armor:10,effect:"armor",icon:"breastplate",name:"iron chest",price:10,set:3},{effect:"heal",health:7,icon:"potion",name:"hp potion iv",price:9,set:3,size:"14px"},{effect:"mana",icon:"potion",mana:7,name:"mp potion iv",price:9,set:3,size:"14px"},{damage:12,effect:"damage",element:"nature",icon:"sword",name:"flora blade",price:11,set:4,size:"15px"},{damage:12,effect:"damage",element:"electric",icon:"sword",name:"shocking sword",price:11,set:4,size:"12px"},{damage:13,effect:"damage",element:"water",icon:"bow",name:"drowned bow",price:12,set:4,size:"15px"},{cost:8,duration:5,effect:"poison",element:"poison",icon:"magic",keyword:"poison",name:"death",price:11,set:4},{cost:8,duration:5,effect:"fire",element:"fire",icon:"magic",keyword:"burn",name:"inferno",price:11,set:4},{cost:8,duration:5,effect:"electric",element:"electric",icon:"magic",keyword:"paralyse",name:"thunder",price:11,set:4},{cost:8,duration:5,effect:"ice",element:"ice",icon:"magic",keyword:"freeze",name:"blizzard",price:11,set:4},{armor:10,effect:"armor",icon:"gloves",name:"mithral gloves",price:9,set:4,size:"12px"},{armor:11,effect:"armor",icon:"helm",name:"mithral helm",price:10,set:4,size:"14px"},{armor:12,effect:"armor",icon:"breastplate",name:"mithral chest",price:11,set:4,size:"13px"},{effect:"heal",health:12,icon:"potion",name:"hp potion v",price:11,set:4,size:"15px"},{effect:"mana",icon:"potion",mana:12,name:"mp potion v",price:11,set:4,size:"15px"}];const j={actionTaken:!1,ad:0,armor:0,availableCards:[],deck:[],gold:0,hp:50,kills:0,maxAd:0,maxHp:50,maxMp:50,mp:50,status:"normal",statusDuration:0,totalGold:0};var W=new class extends s{setInitialDeckState(){this.setState({availableCards:O.filter((e=>"base"===e.set))}).commit(),this.setState({deck:this.generatePlayableDeck()}).commit()}generatePlayableDeck(){const e=0===this.deck,t=this.deck.slice(0,5);return e?this.generateRandomDeckFromAvailableCards(!0):[...t,...this.generateRandomDeckFromAvailableCards(!1)]}generateRandomDeckFromAvailableCards(e){return Array.from(Array(e?40:35).keys()).map((()=>Object.assign({id:f()},h(this.availableCards)[0])))}constructor(e){super(e),this.setInitialDeckState()}}({...j});function V(e,t=!1,a="hand"){const o=[`tm-c-${a}__card tm-c-card`,!t&&W.mp<e.cost?"tm-c-card--disabled":"",t?"":"js-card"].join(" "),n=`background-image: url(${I(e.icon)})`,r=`background-image: url(${I(e.element)})`;var s;return`\n    <div class="${o}" style="${n}" data-id="${null!==(s=e.id)&&void 0!==s?s:f()}">\n      ${e.cost?`<div class="tm-c-card__cost">${e.cost}</div>`:""}\n      ${e.element?`<div class="tm-c-card__element" style="${r}"></div>`:""}\n      <div class="tm-c-card__name" ${e.size?`style="font-size: ${e.size}"`:""}>\n        ${e.name}\n      </div>\n      <div class="tm-c-card__effect">\n        ${e.armor?`+${e.armor} ARM`:""}\n        ${e.damage?`${e.damage} ATK`:""}\n        ${e.health?`+${e.health} HP`:""}\n        ${e.keyword?`${e.keyword}`:""}\n        ${e.mana?`+${e.mana} MP`:""}\n        ${e.maxHealth?`+${e.maxHealth} MAX HP`:""}\n        ${e.maxMana?`+${e.maxMana} MAX MP`:""}\n      </div>\n    </div>\n  `}function K(){return`\n    <div class="tm-c-hand">\n      ${W.deck.slice(0,5).map((e=>V(e))).join("")}\n      <div class="tm-c-hand__discard js-discard"></div>\n    </div>\n  `}var Z=["The Labyrinth of Sinister Malice","The Lost Caverns of the Lich Baroness","The Delve of Byzu","The Forsaken Tomb of the Demon Empress","The Secret Shrine of the Vampire Duchess","The Secret Sepulcher of Evil","The Temple of Fiendish Madness","The Vaults of Damned Terror","The Warrens of Horrendous Secrets","The Halls of Accursed Secrets","The Barrow of the Wraith Princess","The Lair of Lama the Necromancer","The Black Tunnels of Vala the Possessed","The Delve of Thimunda the Indomitable","The Delve of Horrendous Malice","The Secret Barrow of Evil","The Lost Chambers of Maltha","The Tomb of Ghastly Necromancy","The Gauntlet of Infernal Necromancy","The Secret Warrens of Nightmares","The Sepulcher of the Wraith Baron","The Forsaken Hive of Amaz","The Barrow of Demonic Ages","The Lost Labyrinth of Mala the Gruesome","The Forsaken Sanctum of the Gargoyle Tyrant","The Lost Vaults of Secrets","The Dark Vaults of the Shadow Empress","The Barrow of Ghastly Evil","The Dread Temple of Ruin","The Delve of the Vampire Empress","The Sanctum of Kas the Bloody","The Dark Hive of Worms","The Vaults of Demonic Worms","The Sepulcher of Unearthly Sorrows","The Dark Lair of Marbelph","The Forsaken Gauntlet of Abyn the Profane","The Secret Delve of Sorrows","The Black Dungeon of Madness","The Barrow of Saraha","The Vaults of Lord Greywulf","The Lost Tunnels of the Demon Count","The Secret Catacombs of Secrets","The Lost Lair of the Vampire Baroness","The Barrow of Illfang the Kobold Lord","The Black Undercrypt of the Demon Tyrant","The Lost Vaults of the Wyrm Duchess","The Dark Chambers of Sorrows","The Lost Tomb of Horror","The Shrine of Ammos","The Temple of Barbos the Ghastly","The Lost Warrens of Woe","The Forsaken Caverns of Chaos","The Forsaken Prison of the Wraith Princess","The Forsaken Dungeon of Chaos","The Dark Labyrinth of Woe","The Shrine of the Lich Duchess","The Secret Crypts of Worms","The Lost Pit of Illfang the Kobold Lord","The Lost Chambers of Ariger the Baleful","The Vaults of Damned Madness","The Catacombs of Illfang the Kobold Lord","The Dread Tunnels of Woe","The Forsaken Lair of the Wyrm Count","The Lost Shrine of the Shadow Tyrant","The Lost Catacombs of Akvan the Awesome","The Dark Catacombs of Chaos","The Hive of the Vampire Prince","The Black Vaults of Woe","The Black Catacombs of Malice","The Lost Gauntlet of Harida","The Crypts of Asyan the Lunatic","The Secret Caverns of Nabal the Sorceror","The Lost Lair of the Lich Countess","The Dark Tunnels of the Vampire Prince","The Dark Barrow of Sorrows","The Dread Sanctum of Madness","The Hive of Nexas","The Dungeon of Grim Madness","The Dread Pit of Evil","The Warrens of Gothmog of Udun","The Labyrinth of Azun","The Black Lair of Ulfang the Black","The Secret Temple of Zeiram the Lich","The Dread Halls of Horror","The Forsaken Pit of Sorrows","The Black Tomb of Amus","The Hive of Wicked Necromancy","The Dungeon of Misamsu","The Dungeon of Horrendous Devastation","The Black Barrow of Nightmares","The Cyst of Unearthly Ruin","The Forsaken Vaults of Gilda the Merciless","The Warrens of Malefic Devastation","The Caverns of Agares","The Shrine of Crimson Souls","The Crypts of Kas the Bloody","The Tunnels of Vale the Terrible","The Black Halls of Necromancy","The Lost Sanctum of Chaos","The Caverns of Mighty Death","The Forsaken Tomb of Secrets","The Dread Sepulcher of Himarca","The Dread Sepulcher of Lord Greywulf","The Secret Sepulcher of Nightmares","The Tunnels of Gothmog of Udun","The Black Tomb of Malice","The Catacombs of Tenebrous Worms","The Hive of Mighty Chaos","The Halls of Kobyz the Possessed","The Secret Undercrypt of Annihilation","The Black Prison of the Goblin King","The Lost Dungeon of the Vampire Empress","The Hive of Vali","The Dread Undercrypt of Necromancy","The Prison of Elemental Terror","The Undercrypt of Awesome Ages","The Dark Catacombs of Annilus","The Dread Hive of Death","The Sepulcher of Pryala","The Lost Tunnels of Sindaga the Adamant","The Dark Tomb of Kas the Bloody","The Lost Temple of Geberta the Crimson","The Black Tomb of Horror","The Crypts of Arcane Terror","The Secret Warrens of Ruin","The Chambers of Basa","The Secret Delve of Malice","The Dungeon of Arcane Death","The Forsaken Caverns of Horror","The Warrens of Horrendous Horror","The Dread Barrow of Zeiram the Lich","The Barrow of the Lich Baroness","The Crypts of Comiro the Possessed","The Labyrinth of Bloody Souls","The Crypts of Malefic Sorrows","The Sepulcher of Sinister Woe","The Vaults of Gruesome Woe","The Dark Tomb of Myala","The Dark Lair of Souls","The Cyst of Aphotic Death","The Cyst of Alphac","The Lost Prison of Suuhadna","The Temple of Black Devastation","The Dread Undercrypt of Malice","The Black Hive of the Lich Baroness","The Undercrypt of Adamant Horror","The Secret Tomb of Souls","The Vaults of Arbach","The Vaults of Vano the Bloody","The Warrens of Emirkol the Chaotic","The Sanctum of Indomitable Worms","The Prison of Mali the Fiendish","The Warrens of the Gargoyle Emperor","The Catacombs of Fiendish Worms","The Labyrinth of Fiendish Evil","The Secret Sepulcher of the Wraith Duchess","The Vaults of the Lich Count","The Forsaken Undercrypt of Bumisu the Ghastly","The Catacombs of Bloody Worms","The Lost Caverns of Necromancy","The Forsaken Prison of Ages","The Hive of Ulfang the Black","The Catacombs of Wambiga the Baatorian","The Lair of Tenebrous Woe","The Hive of the Wraith Prince","The Dark Vaults of Lord Greywulf","The Prison of Ulfang the Black","The Black Vaults of Terror","The Black Crypts of Gentigoia the Indomitable","The Sanctum of Gusya","The Shrine of the Vampire Baron","The Secret Temple of Souls","The Prison of Nabaalu","The Dungeon of Sunless Annihilation","The Halls of Ghastly Death","The Tunnels of Asbarus the Malevolent","The Hive of Gruesome Sorrows","The Caverns of Ares","The Secret Prison of Sorrows","The Delve of Adamant Worms","The Dark Sepulcher of the Lich Duke","The Lost Caverns of Sorrows","The Labyrinth of Accursed Nightmares","The Secret Lair of Mary","The Black Undercrypt of Malice","The Sanctum of Gloomy Worms","The Dark Caverns of Sorrows","The Secret Pit of Zeiram the Lich","The Undercrypt of Kas the Betrayer","The Black Barrow of Chaos","The Dark Barrow of Souls","The Tomb of Emirkol the Chaotic","The Dread Barrow of Madness","The Labyrinth of Ghastly Evil","The Dark Prison of Kas the Bloody","The Sepulcher of Gothmog of Udun","The Dread Shrine of Worms","The Labyrinth of Fell Annihilation","The Black Vaults of Malice","The Black Barrow of Secrets"];function X(e,t,a="0"){const o=e.toString().length,n=o+t;return`${Array.from(Array(n)).map((()=>a)).join("")}${e}`.slice(-1*Math.max(o,t))}function J(){const e="normal"!==W.status&&0!==W.statusDuration,t=W.hp/W.maxHp*100,a=W.mp/W.maxMp*100,o=0!==W.maxAd?W.ad/W.maxAd*100:0;return`\n    <div class="tm-c-stats">\n      <div class="tm-c-stats__stat" data-stat="health">\n        <div class="tm-c-stats__label">HP</div>\n        <div class="tm-c-stats__value ${W.maxHp>99?"tm-c-stats__value--small":""}">\n          ${X(W.hp,2)} / ${X(W.maxHp,2)}\n        </div>\n        <div class="tm-c-stats__bar" style="width: ${t}%"></div>\n      </div>\n      <div class="tm-c-stats__stat" data-stat="mana">\n        <div class="tm-c-stats__label">MP</div>\n        <div class="tm-c-stats__value ${W.maxMp>99?"tm-c-stats__value--small":""}">\n          ${X(W.mp,2)} / ${X(W.maxMp,2)}\n        </div>\n        <div class="tm-c-stats__bar" style="width: ${a}%"></div>\n      </div>\n      <div class="tm-c-stats__stat" data-stat="armor">\n        <div class="tm-c-stats__label">ARM</div>\n        <div class="tm-c-stats__value">${X(W.armor,2)}</div>\n        <div class="tm-c-stats__bar" style="width: ${o}%"></div>\n      </div>\n      <div class="tm-c-stats__stat" data-stat="status">\n        <div class="tm-c-stats__status-label">Status Effect</div>\n        <div class="tm-c-stats__status-effect">\n          <div class="tm-c-stats__status-icon">\n            ${e?`<img src="${I(W.status)}" />`:""}\n          </div>\n          <div class="tm-c-stats__status-duration">\n            ${e?`x ${W.statusDuration} turns`:""}\n          </div>\n        </div>\n      </div>\n      <div class="tm-c-stats__stat" data-stat="information">\n        <div class="tm-c-stats__gold">* ${W.gold} gold</div>\n        <div class="tm-c-stats__defeated">* ${W.kills} defeated</div>\n        <div class="tm-c-stats__level">* Dungeon lv. ${p.level}</div>\n      </div>\n    </div>\n  `}function Q(e){return document.createRange().createContextualFragment(e)}const ee=[];function te(e,t,a){const o=[e,t,a].toString();ee.includes(o)||(ee.push(o),window.addEventListener(e,(function(e){const o=e.target===window?window:e.target.closest(t);e.selector=o,null!==o&&a.call(o,e)})))}function ae(e,t,a){const o=Object.entries(e);for(const[e,n]of o)if(n[t]===a)return[n,e];return!1}function oe(e,t=[],a=[]){const o=e.split(" "),n=[];for(let e of o)e=e.replace(/%\d+/g,(e=>t[parseInt(e.replace("%",""))-1])),e=a.includes(e)?`<span>${e}</span>`:e,n.push(e);return n.join(" ")}var ne={};e(ne,"PLAYER_ADVANCE_DUNGEON",(function(){return re})),e(ne,"PLAYER_ADVANCE_ENCOUNTER",(function(){return se}));const re={copy:"You advance to lv. %1",direction:"outbound"},se={copy:"You encounter enemy %1",direction:"outbound"};var ce={};e(ce,"PLAYER_CARD_EFFECT_GAIN_ARMOR",(function(){return ie})),e(ce,"PLAYER_CARD_EFFECT_CURE",(function(){return me})),e(ce,"PLAYER_CARD_EFFECT_GAIN_HP",(function(){return de})),e(ce,"PLAYER_CARD_EFFECT_GAIN_MP",(function(){return le})),e(ce,"PLAYER_CARD_EFFECT_CREATURE_RESIST",(function(){return ue})),e(ce,"PLAYER_CARD_EFFECT_REDRAW",(function(){return he})),e(ce,"PLAYER_CARD_EFFECT_DAMAGE",(function(){return fe})),e(ce,"PLAYER_CARD_EFFECT_BREAK_CREATURE_ARMOR",(function(){return _e})),e(ce,"PLAYER_CARD_EFFECT_APPLY_BURN",(function(){return pe})),e(ce,"PLAYER_CARD_EFFECT_APPLY_FREEZE",(function(){return ge})),e(ce,"PLAYER_CARD_EFFECT_APPLY_PARALYSIS",(function(){return ve})),e(ce,"PLAYER_CARD_EFFECT_APPLY_POISON",(function(){return Te}));const ie={copy:"You gain %1 armor from your equipment",direction:"outbound"},me={copy:"You cure yourself of all negative ailments",direction:"outbound"},de={copy:"You restore %1 HP",direction:"outbound"},le={copy:"You restore %1 MP",direction:"outbound"},ue={copy:"Enemy %1 resisted your %2 attack",direction:"outbound"},he={copy:"You re-draw your current hand",direction:"outbound"},fe={copy:"Your attack on enemy %1 lands for %2 damage",direction:"outbound"},_e={copy:"You break the armor of enemy %1",direction:"outbound"},pe={copy:"You burn enemy %1 for %2 turns",direction:"outbound"},ge={copy:"You freeze enemy %1 for %2 turns",direction:"outbound"},ve={copy:"You paralyse enemy %1 for %2 turns",direction:"outbound"},Te={copy:"You poison enemy %1 for %2 turns",direction:"outbound"};var Ee={};e(Ee,"CHECKPOINT_SPECIAL_ERROR",(function(){return Ae})),e(Ee,"CHECKPOINT_PURCHASE",(function(){return ye})),e(Ee,"CHECKPOINT_PURCHASE_ERROR",(function(){return Se}));const Ae={copy:'"You do not possess enough gold for that blessing"',direction:"outbound"},ye={copy:'"Excellent choice! %1 has been added to your deck"',direction:"outbound"},Se={copy:'"You do not possess enough gold to buy that card"',direction:"outbound"};var be={};e(be,"CREATURE_DEATH_CALL",(function(){return Re})),e(be,"CREATURE_DEATH_REWARD",(function(){return Ce}));const Re={copy:"Enemy %1 succumbs to its wounds and perishes",direction:"outbound"},Ce={copy:"You pick up %1 gold from your enemy",direction:"outbound"};var De={};e(De,"CREATURE_EFFECT_GAIN_ARMOR",(function(){return ke})),e(De,"CREATURE_EFFECT_GAIN_HP",(function(){return Le})),e(De,"CREATURE_EFFECT_GAIN_MP",(function(){return Pe})),e(De,"CREATURE_EFFECT_DAMAGE",(function(){return we})),e(De,"CREATURE_EFFECT_BREAK_CREATURE_ARMOR",(function(){return Ue})),e(De,"CREATURE_EFFECT_APPLY_BURN",(function(){return Fe})),e(De,"CREATURE_EFFECT_APPLY_FREEZE",(function(){return He})),e(De,"CREATURE_EFFECT_APPLY_PARALYSIS",(function(){return Me})),e(De,"CREATURE_EFFECT_APPLY_POISON",(function(){return xe}));const ke={copy:"Enemy %1 gains %2 armor",direction:"outbound"},Le={copy:"Enemy %1 restores %2 HP",direction:"outbound"},Pe={copy:"Enemy %1 restores %2 MP",direction:"outbound"},we={copy:"Enemy %1 hits you for %2 damage",direction:"outbound"},Ue={copy:"Enemy %1 breaks your armor",direction:"outbound"},Fe={copy:"Enemy %1 inflicts a burn on you lasting %2 turns",direction:"outbound"},He={copy:"Enemy %1 freezes your body lasting %2 turns",direction:"outbound"},Me={copy:"Enemy %1 paralyses your body lasting %2 turns",direction:"outbound"},xe={copy:"Enemy %1 inflicts poison on you lasting %2 turns",direction:"outbound"};var Ye={};e(Ye,"PLAYER_STATUS_EFFECT_DAMAGE",(function(){return $e})),e(Ye,"PLAYER_STATUS_EFFECT_DISABLED",(function(){return Ne})),e(Ye,"CREATURE_STATUS_EFFECT_DAMAGE",(function(){return Be})),e(Ye,"CREATURE_STATUS_EFFECT_DISABLED",(function(){return qe}));const $e={copy:"You take %1 damage from your %2",direction:"outbound"},Ne={copy:"You are %1 and unable to move",direction:"outbound"},Be={copy:"Enemy %1 takes %2 damage from its %3",direction:"outbound"},qe={copy:"Enemy %1 is %2 and unable to move",direction:"outbound"};var Ge={...ne,...ce,...Ee,...be,...De,...Ye};te("click",".js-buy",(function(e){const t=e.target.closest(".tm-c-shop__card-container").children[0].querySelector(".tm-c-card__name").innerHTML.trim(),a=document.querySelector('.tm-c-message [class*="status"]'),o=[...W.availableCards],[n]=ae(O,"name",t);if(!n)return;if(a.classList.remove("tm-c-shop__status--error"),W.gold-n.price<0)return a.innerHTML=oe(Ge.CHECKPOINT_PURCHASE_ERROR.copy,[]),void a.classList.add("tm-c-shop__status--error");o.push(n),W.setState({gold:W.gold-n.price}).commit(),W.setState({availableCards:o}).commit();const r=[`<span>${c(n.name)}</span>`];a.innerHTML=oe(Ge.CHECKPOINT_PURCHASE.copy,r),u("PLAYER_UPDATE_STATS")}));function Ie(){const e=document.querySelector(".js-discard"),t=Q('\n    <div class="tm-c-hand__discard-wrapper tm-c-hand__discard-wrapper--enter">\n      <div class="tm-c-hand__card tm-c-card"></div>\n    </div>\n  '),a=t.querySelector(".tm-c-hand__card");4===e.children.length&&e.removeChild(e.firstChild);const o=e.lastChild,n=o&&o.querySelector(".tm-c-hand__card"),r=n&&n.style.transform,s=(n&&parseFloat(r.match(/[-\d.]+/)))<0?1:-1,c=Math.floor(14*Math.random()+2)*s;a.style.transform=`rotate(${c}deg)`,e.appendChild(t),setTimeout((()=>{document.querySelector(".js-discard").lastChild.classList.remove("tm-c-hand__discard-wrapper--enter")}),300)}function ze(e,t,a){return e.status===t?e.statusDuration+a:a}function Oe(e){return{electric:"paralyse",fire:"burn",ice:"freeze",poison:"poison"}[e]}var je=["ailments","armor","burn","burns","electric","hand","ice","fire","freeze","freezes","frozen","gold","nature","paralyse","paralysed","paralyses","poison","poisons","water","HP","MP"];function We(e,t,a=(()=>{}),o=10){const n=t.split(/(<[^><]*>)/gi),r=[],s=[];for(const e of n)"<"!==e.substring(0,1)||"<<"===e.substring(0,2)?r.push(...e.split("")):r.push(e);const c=t=>{document.querySelector(e).classList[t?"add":"remove"]("tm-u-type--typing")},i=()=>{if(s.push(r[0]),document.querySelector(e).innerHTML=s.join(""),r.splice(0,1),0===r.length)return c(!1),a();setTimeout(i,o)};c(!0),i()}const Ve=[];let Ke=null,Ze=!1;function Xe(){Ke=setInterval((()=>{if(!0===Ze||0===Ve.length)return;Ze=!0;const e=f(),t=Ve[0],a=document.createElement("div");a.classList.add("tm-c-log__entry"),a.setAttribute("data-id",e),"CREATURE_DEATH"===t.state&&a.classList.add("tm-c-log__death"),"DUNGEON_ADVANCE"===t.state&&a.classList.add("tm-c-log__advance"),document.querySelector(".tm-c-log__container").appendChild(a);We(`.tm-c-log__entry[data-id="${e}"]`,oe(`${"inbound"===t.message.direction?"<< *":">> *"} ${t.message.copy}`,t.variables,je),(()=>{Ze=!1,Ve.splice(0,1)}))}),50)}function Je(e,t=[],a=!1){Ve.push({message:e,state:a,variables:t})}function Qe(e){const t=p.creatures[0];0!==t.ad&&(t.setState({ad:Math.max(t.ad-e,0)}).commit(),0===t.ad&&(t.setState({armor:0,maxAd:0}).commit(),Je(Ge.PLAYER_CARD_EFFECT_BREAK_CREATURE_ARMOR,[t.name])),u("CREATURE_UPDATE"))}function et(){const e=p.creatures[0];W.setState({gold:W.gold+e.raw.gold}).commit(),W.setState({totalGold:W.totalGold+e.raw.gold}).commit(),W.setState({kills:W.kills+1}).commit(),p.advance(),Je(Ge.CREATURE_DEATH_CALL,[e.name],"CREATURE_DEATH"),Je(Ge.CREATURE_DEATH_REWARD,[e.raw.gold]),Je(Ge.PLAYER_ADVANCE_ENCOUNTER,[p.creatures[0].name]),u("CREATURE_UPDATE")}function tt(e){if("armor"===e.effect&&(W.setState({armor:e.armor}).commit(),W.setState({ad:e.armor,maxAd:e.armor}).commit(),Je(Ge.PLAYER_CARD_EFFECT_GAIN_ARMOR,[e.armor]),u("PLAYER_UPDATE_STATS")),"cure"===e.effect&&(W.setState({status:"normal",statusDuration:0}).commit(),Je(Ge.PLAYER_CARD_EFFECT_CURE,[]),u("PLAYER_UPDATE_STATS")),"heal"===e.effect&&(W.setState({hp:Math.min(W.hp+e.health,W.maxHp)}).commit(),Je(Ge.PLAYER_CARD_EFFECT_GAIN_HP,[e.health]),u("PLAYER_UPDATE_STATS")),"mana"===e.effect&&(W.setState({mp:Math.min(W.mp+e.mana,W.maxMp)}).commit(),Je(Ge.PLAYER_CARD_EFFECT_GAIN_MP,[e.mana]),u("PLAYER_UPDATE_STATS")),"damage"===e.effect){const t=p.creatures[0],a=t.raw.weakness&&e.element&&t.raw.weakness===e.element,o=t.armor-e.damage*(a?2:1),n=o<0,r=Math.abs(o);Qe(e.damage*(a?2:1)),e.element&&["electric","fire","ice","poison"].includes(e.element)&&d(.3)&&"normal"===t.status&&tt({duration:2,effect:Oe(e.element)}),n&&t.setState({hp:Math.max(t.hp-r,0)}).commit(),Je(Ge.PLAYER_CARD_EFFECT_DAMAGE,[t.name,r]),u("CREATURE_UPDATE"),u("PLAYER_UPDATE_STATS"),0===t.hp&&et()}if("re-draw"===e.effect&&(W.setState({deck:h(W.deck)}).commit(),Je(Ge.PLAYER_CARD_EFFECT_REDRAW,[]),u("PLAYER_UPDATE_HAND",{shouldMaintainDiscardState:!0})),"burn"===e.effect){const t=p.creatures[0],a=ze(t,"burn",e.duration);t.setState({status:"fire",statusDuration:a}).commit(),Je(Ge.PLAYER_CARD_EFFECT_APPLY_BURN,[t.name,e.duration]),u("CREATURE_UPDATE")}if("freeze"===e.effect){const t=p.creatures[0],a=ze(t,"freeze",e.duration);t.setState({status:"ice",statusDuration:a}).commit(),Je(Ge.PLAYER_CARD_EFFECT_APPLY_FREEZE,[t.name,e.duration]),u("CREATURE_UPDATE")}if("paralyse"===e.effect){const t=p.creatures[0],a=ze(t,"paralyse",e.duration);t.setState({status:"electric",statusDuration:a}).commit(),Je(Ge.PLAYER_CARD_EFFECT_APPLY_PARALYSIS,[t.name,e.duration]),u("CREATURE_UPDATE")}if("poison"===e.effect){const t=p.creatures[0],a=ze(t,"poison",e.duration);t.setState({status:"poison",statusDuration:a}).commit(),Je(Ge.PLAYER_CARD_EFFECT_APPLY_POISON,[t.name,e.duration]),u("CREATURE_UPDATE")}}function at(e){const t=p.creatures[0],a=[...W.deck],[o,n]=ae(a,"id",e);if(o&&(a.splice(parseInt(n),1),a.push(o),!o.cost||0!==Math.max(W.mp-o.cost,0))){if(W.setState({mp:W.mp-(o.cost||0)}).commit(),W.setState({deck:a}).commit(),Ie(),u("PLAYER_UPDATE_STATS"),u("PLAYER_UPDATE_HAND",{shouldMaintainDiscardState:!0}),o.element&&t.raw.resistance===o.element)return Je(Ge.PLAYER_CARD_EFFECT_CREATURE_RESIST,[t.name,o.element]),void u("PLAYER_UPDATE_HAND",{shouldMaintainDiscardState:!0});tt(o)}}te("click",".js-card",(function(e){W.actionTaken||(at(e.selector.getAttribute("data-id")),u("PLAYER_ACTION"),document.querySelector(".tm-c-hand").classList.add("tm-c-hand--disabled"))}));var ot=new class extends s{tick(){this.setState({pointer:this.pointer+50}).commit()}pause(){clearInterval(this.interval)}reset(){this.setState({pointer:0}).commit()}start(){const e=setInterval((()=>{u("TICK_SEGMENT"),this.tick(),this.pointer===this.target+50&&(u("TICK"),this.reset())}),50);this.setState({interval:e}).commit(),Xe()}stop(){this.pause(),this.reset()}}({interval:null,pointer:0,target:3e3});function nt(){p.setState({level:p.level+1}).commit(),p.setState({creatures:p.generateDungeonCreatures()}).commit(),W.setState({actionTaken:!1,status:"active"}).commit(),W.setState({deck:W.generatePlayableDeck()}).commit(),document.querySelector(".tm-c-hand").classList.remove("tm-c-hand--disabled"),document.querySelector(".tm-c-board__message").classList.remove("tm-c-board__message--active"),Je(Ge.PLAYER_ADVANCE_DUNGEON,[p.level],"DUNGEON_ADVANCE"),Je(Ge.PLAYER_ADVANCE_ENCOUNTER,[p.creatures[0].name]),ot.start();const e=document.querySelector(".tm-c-timer");e.parentNode.insertBefore(Q('<div class="tm-c-timer" style="width: 0"></div>'),e),e.parentNode.removeChild(e),u("CREATURE_UPDATE"),u("PLAYER_UPDATE_HAND",{shouldMaintainDiscardState:!0}),u("PLAYER_UPDATE_STATS")}te("click",".js-continue",(function(){nt()}));te("click",".js-restart",(function(){W.setState(j).commit(),W.setInitialDeckState(),p.setState(_).commit(),p.setState({creatures:p.generateDungeonCreatures()}).commit(),ot.start(),document.querySelector(".tm-c-board__message").classList.remove("tm-c-board__message--active"),document.querySelector(".tm-c-log__container").innerHTML="";const e=document.querySelector(".tm-c-timer");e.parentNode.insertBefore(Q('<div class="tm-c-timer" style="width: 0"></div>'),e),e.parentNode.removeChild(e),u("CREATURE_UPDATE"),u("PLAYER_UPDATE_HAND"),u("PLAYER_UPDATE_STATS"),console.log(W.hp,j)}));var rt=[{effect:"heal-hp",health:25,icon:"divine",message:{copy:'"A bright light surrounds you as your health is restored"',direction:"outbound"},name:"divine heal",price:15,set:"special",size:"14px"},{effect:"increase-hp",icon:"divine",maxHealth:25,message:{copy:'"A bright light surrounds you as your total health is increased"',direction:"outbound"},name:"divine touch",price:20,set:"special",size:"14px"},{effect:"heal-mp",icon:"divine",mana:25,message:{copy:'"A bright light surrounds you as your mana is restored"',direction:"outbound"},name:"arcane heal",price:15,set:"special",size:"14px"},{effect:"increase-mp",icon:"divine",maxMana:25,message:{copy:'"A bright light surrounds you as your total mana is increased"',direction:"outbound"},name:"arcane touch",price:20,set:"special",size:"14px"}];te("click",".js-special",(function(e){const t=null!==document.querySelector(".tm-c-shop")?"tm-c-shop__status--error":"tm-c-treasure__status--error",a=document.querySelector('.tm-c-message [class*="status"]'),o=e.target.parentNode.querySelector(".tm-c-card").querySelector(".tm-c-card__name").innerHTML.trim(),[n]=ae(rt,"name",o);if(n){if(a.classList.remove(t),W.gold-n.price<0)return a.innerHTML=oe(Ge.CHECKPOINT_SPECIAL_ERROR.copy),void a.classList.add(t);W.setState({gold:W.gold-n.price}).commit(),"heal-hp"===n.effect&&W.setState({hp:Math.min(W.hp+n.health,W.maxHp)}).commit(),"heal-mp"===n.effect&&W.setState({mp:Math.min(W.mp+n.mana,W.maxMp)}).commit(),"increase-hp"===n.effect&&(W.setState({maxHp:Math.min(W.maxHp+n.maxHealth,999)}).commit(),W.setState({hp:Math.min(W.hp+n.maxHealth,W.maxHp)}).commit()),"increase-mp"===n.effect&&(W.setState({maxMp:Math.min(W.maxMp+n.maxMana,999)}).commit(),W.setState({mp:Math.min(W.mp+n.maxMana,W.maxMp)}).commit()),a.innerHTML=oe(n.message.copy),u("PLAYER_UPDATE_STATS")}}));te("click",".js-start",(function(){document.querySelector(".tm-c-board__message").classList.remove("tm-c-board__message--active"),ot.start(),Je(Ge.PLAYER_ADVANCE_ENCOUNTER,[p.creatures[0].name])}));te("click",".js-take",(function(e){const t=e.target.closest(".tm-c-treasure__card-container").children[0].querySelector(".tm-c-card__name").innerHTML.trim(),a=[...W.availableCards],[o]=ae(O,"name",t);o&&(a.push(o),W.setState({availableCards:a}).commit(),nt())}));te("CREATURE_UPDATE","body",(function(){void 0!==p.creatures[0]&&(document.querySelector(".tm-c-creature").outerHTML=z())}));function st(e){return h(O.filter((e=>e.set<=p.level))).slice(0,e).sort(((e,t)=>e.price-t.price))}function ct(){const e=st(3).map((e=>`\n      <div class="tm-c-shop__card-container">\n        ${V(e,!0,"shop")}\n        <div class="tm-c-shop__card-price">${e.price} gold</div>\n        <div class="tm-c-shop__card-buy js-buy">Buy</div>\n      </div>\n    `)),t=h(rt)[0];return`\n    <div class="tm-c-shop">\n      <div class="tm-c-shop__heading">Mysterious merchant</div>\n      <div class="tm-c-shop__cards">\n        ${e.join("")}\n        <div class="tm-c-shop__card-container tm-c-shop__card-container-bordered">\n          ${V(t,!0,"shop")}\n          <div class="tm-c-shop__card-price">${t.price} gold</div>\n          <div class="tm-c-shop__card-buy js-special">Receive</div>\n        </div>\n      </div>\n      <div class="tm-c-shop__heal-notice">You feel your health and mana replenish a little</div>\n      <div class="tm-c-shop__status">"Choose wisely, this may be your last decision..."</div>\n      <div class="tm-c-shop__continue js-continue">Continue further into the dungeon</div>\n    </div>\n  `}function it(){const e=st(3).map((e=>`\n      <div class="tm-c-treasure__card-container">\n        ${V(e,!0,"treasure")}\n        <div class="tm-c-treasure__card-price"></div>\n        <div class="tm-c-treasure__card-take js-take">Take</div>\n      </div>\n    `)),t=h(rt)[0];return`\n    <div class="tm-c-treasure">\n      <div class="tm-c-treasure__heading">Illustrious treasure room</div>\n      <div class="tm-c-treasure__cards">\n        ${e.join("")}\n        <div class="tm-c-treasure__card-container tm-c-treasure__card-container-bordered">\n          ${V(t,!0,"treasure")}\n          <div class="tm-c-treasure__card-price">${t.price} gold</div>\n          <div class="tm-c-treasure__card-take js-special">Heal</div>\n        </div>\n      </div>\n      <div class="tm-c-treasure__heal-notice">You feel your health and mana replenish a little</div>\n      <div class="tm-c-treasure__status">"Choose wisely... you may only take one"</div>\n      <div class="tm-c-treasure__continue js-continue">Continue further into the dungeon</div>\n    </div>\n  `}te("ENTER_SHOP","body",(function(){ot.stop(),W.setState({actionTaken:!0}).commit();const e=Math.ceil(.05*W.hp),t=Math.ceil(.05*W.mp);W.setState({hp:Math.min(W.hp+e,W.maxHp)}).commit(),W.setState({mp:Math.min(W.mp+t,W.maxMp)}).commit(),document.querySelector(".tm-c-timer").style.width="100%",document.querySelector(".tm-c-hand").classList.add("tm-c-hand--disabled"),document.querySelector(".tm-c-board__message").classList.add("tm-c-board__message--active");const a=Math.round(10*Math.random())>7?it:ct;document.querySelector(".tm-c-message__container").innerHTML=a(null)}));te("PLAYER_ACTION","body",(function(){W.setState({actionTaken:!0}).commit()}));te("PLAYER_UPDATE_HAND","body",(function(e){const t=document.querySelector(".js-discard").children,a=Array.from(t);if(document.querySelector(".tm-c-hand").outerHTML=K(),void 0!==e.detail.shouldMaintainDiscardState)for(const e of a)document.querySelector(".js-discard").appendChild(e)}));te("PLAYER_UPDATE_STATS","body",(function(){document.querySelector(".tm-c-stats").outerHTML=J()}));function mt(e){const t=p.creatures[0];0!==W.ad&&(W.setState({ad:Math.max(W.ad-e,0)}).commit(),0===W.ad&&(W.setState({armor:0,maxAd:0}).commit(),Je(Ge.CREATURE_EFFECT_BREAK_CREATURE_ARMOR,[t.name])),u("PLAYER_UPDATE_STATS"))}function dt(e){const t=p.creatures[0];if("damage"===e.effect){const o=W.armor-e.damage*t.statModifier,n=o<0,r=Math.abs(o);var a;const s=null!==(a=e.message)&&void 0!==a?a:Ge.CREATURE_EFFECT_DAMAGE;mt(e.damage*t.statModifier),e.element&&["electric","fire","ice","poison"].includes(e.element)&&d(.3)&&"normal"===W.status&&dt({duration:2,effect:Oe(e.element)}),n&&W.setState({hp:Math.max(W.hp-r,0)}).commit(),Je(s,[t.name,r]),u("PLAYER_UPDATE_STATS")}if("heal"===e.effect){const a=e.health*t.statModifier;var o;const n=null!==(o=e.message)&&void 0!==o?o:Ge.CREATURE_EFFECT_GAIN_HP;t.setState({hp:Math.min(t.hp+a,W.maxHp)}).commit(),Je(n,[t.name,a]),u("CREATURE_UPDATE")}if("mana"===e.effect){const a=e.mana*t.statModifier;var n;const o=null!==(n=e.message)&&void 0!==n?n:Ge.CREATURE_EFFECT_GAIN_MP;t.setState({mp:Math.min(t.mp+a,W.maxMp)}).commit(),Je(o,[t.name,a]),u("CREATURE_UPDATE")}if("protect"===e.effect){const a=e.armor*t.statModifier;var r;const o=null!==(r=e.message)&&void 0!==r?r:Ge.CREATURE_EFFECT_GAIN_ARMOR;t.setState({ad:a,armor:a,maxAd:a}).commit(),Je(o,[t.name,a]),u("CREATURE_UPDATE")}if("burn"===e.effect){const a=e.duration*t.statModifier,o=ze(W,"burn",a);var s;const n=null!==(s=e.message)&&void 0!==s?s:Ge.CREATURE_EFFECT_APPLY_BURN;W.setState({status:"fire",statusDuration:o}).commit(),Je(n,[t.name,a]),u("PLAYER_UPDATE_STATS")}if("freeze"===e.effect){const a=e.duration*t.statModifier,o=ze(W,"freeze",a);var c;const n=null!==(c=e.message)&&void 0!==c?c:Ge.CREATURE_EFFECT_APPLY_FREEZE;W.setState({status:"ice",statusDuration:o}).commit(),Je(n,[t.name,a]),u("PLAYER_UPDATE_STATS")}if("paralyse"===e.effect){const a=e.duration*t.statModifier,o=ze(W,"freeze",a);var i;const n=null!==(i=e.message)&&void 0!==i?i:Ge.CREATURE_EFFECT_APPLY_PARALYSIS;W.setState({status:"electric",statusDuration:o}).commit(),Je(n,[t.name,a]),u("PLAYER_UPDATE_STATS")}if("poison"===e.effect){const a=e.duration*t.statModifier,o=ze(W,"poison",a);var m;const n=null!==(m=e.message)&&void 0!==m?m:Ge.CREATURE_EFFECT_APPLY_POISON;W.setState({status:"poison",statusDuration:o}).commit(),Je(n,[t.name,a]),u("PLAYER_UPDATE_STATS")}}function lt(){const e=p.creatures[0];if(void 0===e.raw.specials)return!1;const t=e.raw.specials.reduce(((e,t)=>(d(t.chance)&&e.push(t),e)),[]);if(0===t.length)return!1;const a=h(t)[0],o=void 0!==a.cost?a.cost:0;return!(e.mp-o<0)&&(e.setState({mp:e.mp-o}).commit(),u("CREATURE_UPDATE"),dt(a),!0)}function ut(){const e=p.creatures[0];if(lt())return;const t=W.armor-e.raw.attack,a=t<0,o=Math.abs(t);mt(e.raw.attack),a&&W.setState({hp:Math.max(W.hp-o,0)}).commit(),Je(Ge.CREATURE_EFFECT_DAMAGE,[e.name,o]),u("PLAYER_UPDATE_STATS")}function ht(){const e=p.creatures[0],t=e.status;if("electric"===t||"ice"===t){if(e.setState({statusDuration:e.statusDuration-1}).commit(),0!==e.statusDuration){const a="electric"===t?"paralysed":"frozen";Je(Ge.CREATURE_STATUS_EFFECT_DISABLED,[e.name,a]),e.setState({actionTaken:!0}).commit()}0===e.statusDuration&&e.setState({status:"normal"}).commit()}if("fire"===t||"poison"===t){if(e.setState({statusDuration:e.statusDuration-1}).commit(),0!==e.statusDuration){const a=Math.ceil(.05*e.hp),o="fire"===t?"burn":"poison";e.setState({hp:Math.max(e.hp-a,0)}).commit(),Je(Ge.CREATURE_STATUS_EFFECT_DAMAGE,[e.name,a,o])}0===e.statusDuration&&e.setState({status:"normal"}).commit()}u("CREATURE_UPDATE")}function ft(){ot.stop(),W.setState({actionTaken:!0}).commit(),document.querySelector(".tm-c-hand").classList.add("tm-c-hand--disabled"),document.querySelector(".tm-c-board__message").classList.add("tm-c-board__message--active"),document.querySelector(".tm-c-message__container").innerHTML=`\n    <div class="tm-c-death">\n      <div class="tm-c-death__heading">You died</div>\n      <div class="tm-c-death__icon">\n        <img src="${I("crowned-skull")}" />\n      </div>\n      <div class="tm-c-death__level">\n        Valiantly, you managed to reach lv. ${p.level} of the dungeon.\n      </div>\n      <div class="tm-c-death__gold">\n        You killed ${W.kills} creature(s) and collected ${W.totalGold} total gold.\n      </div>\n      <div class="tm-c-death__restart js-restart">Re-enter the dungeon</div>\n    </div>\n  `}function _t(){const e=W.status;if("electric"===e||"ice"===e){if(W.setState({statusDuration:W.statusDuration-1}).commit(),0!==W.statusDuration){Je(Ge.PLAYER_STATUS_EFFECT_DISABLED,["electric"===e?"paralysed":"frozen"]),u("PLAYER_ACTION"),document.querySelector(".tm-c-hand").classList.add("tm-c-hand--disabled")}0===W.statusDuration&&W.setState({status:"normal"}).commit()}if("fire"===e||"poison"===e){if(W.setState({statusDuration:W.statusDuration-1}).commit(),0!==W.statusDuration){const t=Math.ceil(.05*W.hp),a="fire"===e?"burn":"poison";W.setState({hp:Math.max(W.hp-t,0)}).commit(),Je(Ge.PLAYER_STATUS_EFFECT_DAMAGE,[t,a])}0===W.statusDuration&&W.setState({status:"normal"}).commit()}u("PLAYER_UPDATE_STATS")}function pt(){const e=document.querySelector(".tm-c-timer");e.parentNode.insertBefore(Q('<div class="tm-c-timer" style="width: 0"></div>'),e),e.parentNode.removeChild(e)}te("TICK","body",(function(){const e=p.creatures[0];W.setState({actionTaken:!1}).commit(),document.querySelector(".tm-c-hand").classList.remove("tm-c-hand--disabled"),ht(),0===e.hp&&et(),_t(),ut(),0===W.hp&&ft(),pt()}));te("TICK_SEGMENT","body",(function(){const e=document.querySelector(".tm-c-timer"),t=parseFloat(e.style.width)+100/(ot.target/50)*100/100;e.style.width=`${t}%`}));var gt;gt=new URL(r("hqokU").resolve("fx1J3"),import.meta.url).toString(),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register(gt)}));const vt=document.getElementById("dungeon");vt.appendChild(Q(`<div class="tm-c-title">${"Dungeon Delver"}</div>`)),vt.appendChild(Q(`\n    <div class="tm-c-board">\n      <div class="tm-c-board__timer"><div class="tm-c-timer" style="width: 0"></div></div>\n      <div class="tm-c-board__creature">\n        ${z()}\n    <div class="tm-c-log">\n      <div class="tm-c-log__container"></div>\n    </div>\n  \n      </div>\n      <div class="tm-c-board__hand">${K()}</div>\n      <div class="tm-c-board__message">${function(e=(()=>{})){return`\n    <div class="tm-c-message">\n      <div class="tm-c-message__container">${e()}</div>\n    </div>\n  `}()}</div>\n    </div>\n  `)),vt.appendChild(Q(J())),document.querySelector(".tm-c-footer").classList.add("tm-c-footer--active"),document.querySelector(".tm-c-board__message").classList.add("tm-c-board__message--active"),document.querySelector(".tm-c-message__container").innerHTML=`\n    <div class="tm-c-start">\n      <div class="tm-c-start__heading">You approach the dungeon gate</div>\n      <div class="tm-c-start__icon">\n        <img src="${I("dungeon-gate")}" />\n      </div>\n      <div class="tm-c-start__name">"${h(Z)[0]}"</div>\n      <div class="tm-c-start__description">\n        <p>A large dark cave in a shady forest marks the dungeon enterance.\n        Beyond the gate lies a narrow, foggy room covered in ash, dirt and broken stone.</p>\n        <p>Your torch allows you to see remnants of statues, demolished by time itself.</p>\n      </div>\n      <div class="tm-c-start__start js-start">Enter the dungeon</div>\n    </div>\n  `;
//# sourceMappingURL=index.c1c61e67.js.map
